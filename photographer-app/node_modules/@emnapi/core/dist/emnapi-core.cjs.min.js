var r=require("@emnapi/wasi-threads");const e="undefined"!=typeof WebAssembly?WebAssembly:"undefined"!=typeof WXWebAssembly?WXWebAssembly:void 0;function t(r){if(r&&"object"!=typeof r)throw new TypeError("imports must be an object or undefined");return!0}function n(r,a){if(!r)throw new TypeError("Invalid wasm source");t(a),a=null!=a?a:{};try{const e="object"==typeof r&&null!==r&&"then"in r?r.then:void 0;if("function"==typeof e)return e.call(r,r=>n(r,a))}catch(r){}if(r instanceof ArrayBuffer||ArrayBuffer.isView(r))return e.instantiate(r,a);if(r instanceof e.Module)return e.instantiate(r,a).then(e=>({instance:e,module:r}));if("undefined"!=typeof Response&&r instanceof Response)return r.arrayBuffer().then(r=>e.instantiate(r,a));const o="string"==typeof r;if(o||"undefined"!=typeof URL&&r instanceof URL){if(o&&"undefined"!=typeof wx&&"undefined"!=typeof __wxConfig)return e.instantiate(r,a);if("function"!=typeof fetch)throw new TypeError("wasm source can not be a string or URL in this environment");if("function"!=typeof e.instantiateStreaming)return n(fetch(r),a);try{return e.instantiateStreaming(fetch(r),a).catch(()=>n(fetch(r),a))}catch(e){return n(fetch(r),a)}}throw new TypeError("Invalid wasm source")}function a(t){var n=function(){var n,a,o,s,i,u="object"==typeof process&&null!==process&&"object"==typeof process.versions&&null!==process.versions&&"string"==typeof process.versions.node,f=Boolean(t.childThread),c="number"==typeof t.waitThreadStart?t.waitThreadStart:Boolean(t.waitThreadStart);function l(r){if("function"==typeof e.RuntimeError)throw new e.RuntimeError(r);throw Error(r)}var d,p,v,g={imports:{env:{},napi:{},emnapi:{}},exports:{},emnapi:{},loaded:!1,filename:"",childThread:f,initWorker:void 0,executeAsyncWork:void 0,waitThreadStart:c,PThread:void 0,init:function(r){if(g.loaded)return g.exports;if(!r)throw new TypeError("Invalid napi init options");var t=r.instance;if(!(null==t?void 0:t.exports))throw new TypeError("Invalid wasm instance");n=t;var u=t.exports,f=r.module,c=r.memory||u.memory,v=r.table||u.__indirect_function_table;if(!(f instanceof e.Module))throw new TypeError("Invalid wasm module");if(!(c instanceof e.Memory))throw new TypeError("Invalid wasm memory");if(!(v instanceof e.Table))throw new TypeError("Invalid wasm table");if(a=c,o=v,"function"!=typeof u.malloc)throw new TypeError("malloc is not exported");if("function"!=typeof u.free)throw new TypeError("free is not exported");if(s=u.malloc,i=u.free,!g.childThread){var y=8,h=t.exports.node_api_module_get_api_version_v1;"function"==typeof h&&(y=h());var E=g.envObject||(g.envObject=d.createEnv(g.filename,y,function(r){return o.get(r)},function(r){return o.get(r)},l,p)),_=d.openScope(E);try{E.callIntoModule(function(r){var e=g.exports,n=_.add(e),a=(0,t.exports.napi_register_wasm_v1)(r.id,n.id);g.exports=a?d.handleStore.get(a).value:e})}catch(r){if("unwind"!==r)throw r}finally{d.closeScope(E,_)}return g.loaded=!0,delete g.envObject,g.exports}}},y=void 0;if(f){d=null==t?void 0:t.context;var h="function"==typeof t.postMessage?t.postMessage:"function"==typeof postMessage?postMessage:void 0;if("function"!=typeof h)throw new TypeError("No postMessage found");g.postMessage=h}else{var E=t.context;if("object"!=typeof E||null===E)throw new TypeError("Invalid `options.context`. Use `import { getDefaultContext } from '@emnapi/runtime'`");d=E}if("string"==typeof t.filename&&(g.filename=t.filename),"function"==typeof t.onCreateWorker&&(y=t.onCreateWorker),"function"==typeof t.print?t.print:console.log.bind(console),v="function"==typeof t.printErr?t.printErr:console.warn.bind(console),"nodeBinding"in t){var _=t.nodeBinding;if("object"!=typeof _||null===_)throw new TypeError("Invalid `options.nodeBinding`. Use @emnapi/node-binding package");p=_}var w=0;if("asyncWorkPoolSize"in t){if("number"!=typeof t.asyncWorkPoolSize)throw new TypeError("options.asyncWorkPoolSize must be a integer");(w=t.asyncWorkPoolSize|0)>1024?w=1024:w<-1024&&(w=-1024)}var L=!f&&w<=0;function m(){return Math.abs(w)}function b(r){if(!r)return!1;if(r._emnapiSendListener)return!0;var e=function(r){var e=(u?r:r.data).__emnapi__;if(e&&"async-send"===e.type)if(f){(0,g.postMessage)({__emnapi__:e})}else{var t=e.payload.callback;o.get(t)(e.payload.data)}};return r._emnapiSendListener={handler:e,dispose:function(){u?r.off("message",e):r.removeEventListener("message",e,!1),delete r._emnapiSendListener}},u?r.on("message",e):r.addEventListener("message",e,!1),!0}g.imports.env._emnapi_async_work_pool_size=m,g.emnapi.addSendListener=b;var S=new r.ThreadManager(f?{printErr:v,childThread:!0}:{printErr:v,beforeLoad:function(r){b(r)},reuseWorker:t.reuseWorker,onCreateWorker:y});function C(r,e){d.feature.setImmediate(function(){o.get(r)(e)})}function A(r,e){Promise.resolve().then(function(){o.get(r)(e)})}function I(r,e){var t,n=[e>>>0,(t=e,+Math.abs(t)>=1?t>0?(0|Math.min(+Math.floor(t/4294967296),4294967295))>>>0:~~+Math.ceil((t-+(~~t>>>0))/4294967296)>>>0:0)],o=new DataView(a.buffer);o.setInt32(r,n[0],!0),o.setInt32(r+4,n[1],!0)}g.PThread=S;var k,V=Object.freeze({__proto__:null,$emnapiSetValueI64:I,_emnapi_call_finalizer:function(r,e,t,n,a){d.envStore.get(e).callFinalizerInternal(r,t,n,a)},_emnapi_callback_into_module:function(r,e,t,n,a){var s=d.envStore.get(e),i=d.openScope(s);try{s.callbackIntoModule(Boolean(r),function(){o.get(t)(e,n)})}catch(r){throw d.closeScope(s,i),a&&d.closeScope(s),r}d.closeScope(s,i)},_emnapi_close_handle_scope:function(r){return d.closeScope()},_emnapi_ctx_decrease_waiting_request_counter:function(){d.decreaseWaitingRequestCounter()},_emnapi_ctx_increase_waiting_request_counter:function(){d.increaseWaitingRequestCounter()},_emnapi_get_node_version:function(r,e,t){var n="object"==typeof process&&null!==process&&"object"==typeof process.versions&&null!==process.versions&&"string"==typeof process.versions.node?process.versions.node.split(".").map(function(r){return Number(r)}):[0,0,0],o=new DataView(a.buffer);o.setUint32(r,n[0],!0),o.setUint32(e,n[1],!0),o.setUint32(t,n[2],!0)},_emnapi_get_now:function(){return performance.timeOrigin+performance.now()},_emnapi_is_main_browser_thread:function(){return"undefined"==typeof window||"undefined"==typeof document||u?0:1},_emnapi_is_main_runtime_thread:function(){return f?0:1},_emnapi_next_tick:A,_emnapi_open_handle_scope:function(){return d.openScope().id},_emnapi_runtime_keepalive_pop:function(){},_emnapi_runtime_keepalive_push:function(){},_emnapi_set_immediate:C,_emnapi_unwind:function(){throw"unwind"},napi_clear_last_error:function(r){return d.envStore.get(r).clearLastError()},napi_set_last_error:function(r,e,t,n){return d.envStore.get(r).setLastError(e,t,n)}});function U(r){var e=new DataView(a.buffer).getInt32(r+20,!0);return S.pthreads[e]}var T=new Promise(function(r){k=function(){T.ready=!0,r()}});T.ready=!1;var B=Object.freeze({__proto__:null,_emnapi_after_uvthreadpool_ready:function(r,e,t){T.ready?o.get(r)(e,t):T.then(function(){o.get(r)(e,t)})},_emnapi_async_send_js:function(r,e,t){if(f)(0,g.postMessage)({__emnapi__:{type:"async-send",payload:{callback:e,data:t}}});else switch(r){case 0:C(e,t);break;case 1:A(e,t)}},_emnapi_emit_async_thread_ready:function(){f&&(0,g.postMessage)({__emnapi__:{type:"async-thread-ready",payload:{}}})},_emnapi_tell_js_uvthreadpool:function(r,e){for(var t=[],n=new DataView(a.buffer),o=function(e){var a=U(n.getUint32(r+4*e,!0));t.push(new Promise(function(r){var e=function(t){var n=(u?t:t.data).__emnapi__;n&&"async-thread-ready"===n.type&&(r(),a&&"function"==typeof a.unref&&a.unref(),u?a.off("message",e):a.removeEventListener("message",e))};u?a.on("message",e):a.addEventListener("message",e)}))},s=0;s<e;s++)o(s);Promise.all(t).then(k)},_emnapi_worker_unref:function(r){if(!f){var e=U(r);e&&"function"==typeof e.unref&&e.unref()}}});var D=Object.freeze({__proto__:null,napi_adjust_external_memory:function(r,e,t){if(!r)return 1;var n=d.envStore.get(r);if(!t)return n.setLastError(1);var o=Number(e);if(o<0)return n.setLastError(1);var s=a.buffer.byteLength,i=s+o;return i+=(65536-i%65536)%65536,-1===a.grow(i-s+65535>>16)?n.setLastError(9):(d.feature.supportBigInt?new DataView(a.buffer).setBigInt64(t,BigInt(a.buffer.byteLength),!0):I(t,a.buffer.byteLength),n.clearLastError())}}),j={idGen:{},values:[void 0],queued:new Set,pending:[],init:function(){var r={nextId:1,list:[],generate:function(){var e;return r.list.length?e=r.list.shift():(e=r.nextId,r.nextId++),e},reuse:function(e){r.list.push(e)}};j.idGen=r,j.values=[void 0],j.queued=new Set,j.pending=[]},create:function(r,e,t,n,a,o){var s=0,i=0;if(p){var u=p.node.emitAsyncInit(e,t,-1);s=u.asyncId,i=u.triggerAsyncId}var f=j.idGen.generate();return j.values[f]={env:r,id:f,resource:e,asyncId:s,triggerAsyncId:i,status:0,execute:n,complete:a,data:o},f},callComplete:function(r,e){var t=r.complete,n=r.env,a=r.data,s=function(){if(t){var r=d.envStore.get(n),s=d.openScope(r);try{r.callbackIntoModule(!0,function(){o.get(t)(n,e,a)})}finally{d.closeScope(r,s)}}};p?p.node.makeCallback(r.resource,s,[],{asyncId:r.asyncId,triggerAsyncId:r.triggerAsyncId}):s()},queue:function(r){var e=j.values[r];if(e&&0===e.status){if(e.status=1,j.queued.size>=(Math.abs(w)||4))return void j.pending.push(r);j.queued.add(r);var t=e.env,n=e.data,a=e.execute;e.status=2,d.feature.setImmediate(function(){if(o.get(a)(t,n),j.queued.delete(r),e.status=3,d.feature.setImmediate(function(){j.callComplete(e,0)}),j.pending.length>0){var s=j.pending.shift();j.values[s].status=0,j.queue(s)}})}},cancel:function(r){var e=j.pending.indexOf(r);if(-1!==e){var t=j.values[r];return t&&1===t.status?(t.status=4,j.pending.splice(e,1),d.feature.setImmediate(function(){j.callComplete(t,11)}),0):9}return 9},remove:function(r){var e=j.values[r];e&&(p&&p.node.emitAsyncDestroy({asyncId:e.asyncId,triggerAsyncId:e.triggerAsyncId}),j.values[r]=void 0,j.idGen.reuse(r))}};function x(r,e,t,n){if(p){var o=d.handleStore.get(r).value,s=d.handleStore.get(e).value,i=p.node.emitAsyncInit(o,s,t),u=i.asyncId,f=i.triggerAsyncId;if(n){var c=new DataView(a.buffer);c.setFloat64(n,u,!0),c.setFloat64(n+8,f,!0)}}}function R(r,e){p&&p.node.emitAsyncDestroy({asyncId:r,triggerAsyncId:e})}var G=Object.freeze({__proto__:null,_emnapi_async_destroy_js:function(r){if(!p)return 9;var e=new DataView(a.buffer),t=e.getInt32(r,!0),n=e.getInt32(r+4,!0),o=BigInt(t>>>0)|BigInt(n)<<BigInt(32),s=p.napi.asyncDestroy(o);return 0!==s.status?s.status:0},_emnapi_async_init_js:function(r,e,t){if(!p)return 9;var n;r&&(n=Object(d.handleStore.get(r).value));var o=d.handleStore.get(e).value,s=p.napi.asyncInit(n,o);if(0!==s.status)return s.status;var i=s.value;i>=BigInt(-1)*(BigInt(1)<<BigInt(63))&&i<BigInt(1)<<BigInt(63)||(i&=(BigInt(1)<<BigInt(64))-BigInt(1))>=BigInt(1)<<BigInt(63)&&(i-=BigInt(1)<<BigInt(64));var u=Number(i&BigInt(4294967295)),f=Number(i>>BigInt(32)),c=new DataView(a.buffer);return c.setInt32(t,u,!0),c.setInt32(t+4,f,!0),0},_emnapi_env_check_gc_access:function(r){d.envStore.get(r).checkGCAccess()},_emnapi_node_emit_async_destroy:R,_emnapi_node_emit_async_init:x,_emnapi_node_make_callback:function(r,e,t,n,o,s,i,u){var f,c=0;if(p){var l=d.handleStore.get(e).value,v=d.handleStore.get(t).value;o>>>=0;for(var g=Array(o),y=new DataView(a.buffer);c<o;c++){var h=y.getUint32(n+4*c,!0);g[c]=d.handleStore.get(h).value}var E=p.node.makeCallback(l,v,g,{asyncId:s,triggerAsyncId:i});if(u)f=d.envStore.get(r).ensureHandleId(E),y.setUint32(u,f,!0)}},napi_close_callback_scope:function(r,e){throw new Error("napi_close_callback_scope has not been implemented yet")},napi_make_callback:function(r,e,t,n,o,s,i){var u,f=0;if(!r)return 1;var c=d.envStore.get(r);if(c.checkGCAccess(),!c.tryCatch.isEmpty())return c.setLastError(10);if(!c.canCallIntoJs())return c.setLastError(c.moduleApiVersion>=10?23:10);c.clearLastError();try{if(!p)return c.setLastError(9);if(!t)return c.setLastError(1);if(o>0&&!s)return c.setLastError(1);var l=Object(d.handleStore.get(t).value),v=d.handleStore.get(n).value;if("function"!=typeof v)return c.setLastError(1);var g=new DataView(a.buffer),y=g.getInt32(e,!0),h=g.getInt32(e+4,!0),E=BigInt(y>>>0)|BigInt(h)<<BigInt(32);o>>>=0;for(var _=Array(o);f<o;f++){var w=g.getUint32(s+4*f,!0);_[f]=d.handleStore.get(w).value}var L=p.napi.makeCallback(E,l,v,_);if(L.error)throw L.error;return 0!==L.status?c.setLastError(L.status):(i&&(u=c.ensureHandleId(L.value),g.setUint32(i,u,!0)),c.getReturnStatus())}catch(r){return c.tryCatch.setError(r),c.setLastError(10)}},napi_open_callback_scope:function(r,e,t,n){throw new Error("napi_open_callback_scope has not been implemented yet")}}),O={offset:{resource:0,async_id:8,trigger_async_id:16,queue_size:24,queue:28,thread_count:32,is_closing:36,dispatch_state:40,context:44,max_queue_size:48,ref:52,env:56,finalize_data:60,finalize_cb:64,call_js_cb:68,handles_closing:72,async_ref:76,mutex:80,cond:84,end:88},init:function(){if(void 0!==S){S.unusedWorkers.forEach(O.addListener),S.runningWorkers.forEach(O.addListener);var r=S.getNewWorker;S.getNewWorker=function(){var e=r.apply(this,arguments);return O.addListener(e),e}}},addListener:function(r){if(!r)return!1;if(r._emnapiTSFNListener)return!0;var e=function(r){var e=(u?r:r.data).__emnapi__;if(e){var t=e.type,n=e.payload;"tsfn-send"===t&&O.dispatch(n.tsfn)}};return r._emnapiTSFNListener={handler:e,dispose:function(){u?r.off("message",e):r.removeEventListener("message",e,!1),delete r._emnapiTSFNListener}},u?r.on("message",e):r.addEventListener("message",e,!1),!0},initQueue:function(r){var e=s(8);return!!e&&(new Uint8Array(a.buffer,e,8).fill(0),O.storeSizeTypeValue(r+O.offset.queue,e,!1),!0)},destroyQueue:function(r){var e=O.loadSizeTypeValue(r+O.offset.queue,!1);e&&i(e)},pushQueue:function(r,e){var t=O.loadSizeTypeValue(r+O.offset.queue,!1),n=O.loadSizeTypeValue(t,!1),a=O.loadSizeTypeValue(t+4,!1),o=s(8);if(!o)throw new Error("OOM");O.storeSizeTypeValue(o,e,!1),O.storeSizeTypeValue(o+4,0,!1),0===n&&0===a?(O.storeSizeTypeValue(t,o,!1),O.storeSizeTypeValue(t+4,o,!1)):(O.storeSizeTypeValue(a+4,o,!1),O.storeSizeTypeValue(t+4,o,!1)),O.addQueueSize(r)},shiftQueue:function(r){var e=O.loadSizeTypeValue(r+O.offset.queue,!1),t=O.loadSizeTypeValue(e,!1);if(0===t)return 0;var n=t,a=O.loadSizeTypeValue(t+4,!1);O.storeSizeTypeValue(e,a,!1),0===a&&O.storeSizeTypeValue(e+4,0,!1),O.storeSizeTypeValue(n+4,0,!1);var o=O.loadSizeTypeValue(n,!1);return i(n),O.subQueueSize(r),o},push:function(r,e,t){var n=O.getMutex(r),a=O.getCond(r),o=function(){var e=O.getQueueSize(r),t=O.getMaxQueueSize(r),n=O.getIsClosing(r);return e>=t&&t>0&&!n},s="undefined"!=typeof window&&"undefined"!=typeof document&&!u;return n.execute(function(){for(;o();){if(0===t)return 15;if(s)return 21;a.wait()}return O.getIsClosing(r)?0===O.getThreadCount(r)?1:(O.subThreadCount(r),16):(O.pushQueue(r,e),O.send(r),0)})},getMutex:function(r){var e=r+O.offset.mutex,t={lock:function(){var r="undefined"!=typeof window&&"undefined"!=typeof document&&!u,t=new Int32Array(a.buffer,e,1);if(r)for(;;){if(0===Atomics.compareExchange(t,0,0,1))return}else for(;;){if(0===Atomics.compareExchange(t,0,0,1))return;Atomics.wait(t,0,1)}},unlock:function(){var r=new Int32Array(a.buffer,e,1);if(1!==Atomics.compareExchange(r,0,1,0))throw new Error("Tried to unlock while not holding the mutex");Atomics.notify(r,0,1)},execute:function(r){t.lock();try{return r()}finally{t.unlock()}}};return t},getCond:function(r){var e=r+O.offset.cond,t=O.getMutex(r);return{wait:function(){var r=new Int32Array(a.buffer,e,1),n=Atomics.load(r,0);t.unlock(),Atomics.wait(r,0,n),t.lock()},signal:function(){var r=new Int32Array(a.buffer,e,1);Atomics.add(r,0,1),Atomics.notify(r,0,1)}}},getQueueSize:function(r){return O.loadSizeTypeValue(r+O.offset.queue_size,!0)},addQueueSize:function(r){var e,t,n=O.offset.queue_size;e=new Uint32Array(a.buffer),t=r+n>>2,Atomics.add(e,t,1)},subQueueSize:function(r){var e,t,n=O.offset.queue_size;e=new Uint32Array(a.buffer),t=r+n>>2,Atomics.sub(e,t,1)},getThreadCount:function(r){return O.loadSizeTypeValue(r+O.offset.thread_count,!0)},addThreadCount:function(r){var e,t,n=O.offset.thread_count;e=new Uint32Array(a.buffer),t=r+n>>2,Atomics.add(e,t,1)},subThreadCount:function(r){var e,t,n=O.offset.thread_count;e=new Uint32Array(a.buffer),t=r+n>>2,Atomics.sub(e,t,1)},getIsClosing:function(r){return Atomics.load(new Int32Array(a.buffer),r+O.offset.is_closing>>2)},setIsClosing:function(r,e){Atomics.store(new Int32Array(a.buffer),r+O.offset.is_closing>>2,e)},getHandlesClosing:function(r){return Atomics.load(new Int32Array(a.buffer),r+O.offset.handles_closing>>2)},setHandlesClosing:function(r,e){Atomics.store(new Int32Array(a.buffer),r+O.offset.handles_closing>>2,e)},getDispatchState:function(r){return Atomics.load(new Uint32Array(a.buffer),r+O.offset.dispatch_state>>2)},getContext:function(r){return O.loadSizeTypeValue(r+O.offset.context,!1)},getMaxQueueSize:function(r){return O.loadSizeTypeValue(r+O.offset.max_queue_size,!0)},getEnv:function(r){return O.loadSizeTypeValue(r+O.offset.env,!1)},getCallJSCb:function(r){return O.loadSizeTypeValue(r+O.offset.call_js_cb,!1)},getRef:function(r){return O.loadSizeTypeValue(r+O.offset.ref,!1)},getResource:function(r){return O.loadSizeTypeValue(r+O.offset.resource,!1)},getFinalizeCb:function(r){return O.loadSizeTypeValue(r+O.offset.finalize_cb,!1)},getFinalizeData:function(r){return O.loadSizeTypeValue(r+O.offset.finalize_data,!1)},loadSizeTypeValue:function(r,e){var t;return e?(t=new Uint32Array(a.buffer),Atomics.load(t,r>>2)):(t=new Int32Array(a.buffer),Atomics.load(t,r>>2))},storeSizeTypeValue:function(r,e,t){var n;return t?(n=new Uint32Array(a.buffer),void Atomics.store(n,r>>2,e)):(n=new Int32Array(a.buffer),void Atomics.store(n,r>>2,e>>>0))},destroy:function(r){O.destroyQueue(r);var e=O.getEnv(r),t=d.envStore.get(e),n=O.getRef(r);n&&d.refStore.get(n).dispose(),d.removeCleanupHook(t,O.cleanup,r),t.unref();var o=r+O.offset.async_ref>>2,s=new Int32Array(a.buffer);Atomics.load(s,o)&&(Atomics.store(s,o,0),d.decreaseWaitingRequestCounter());var u=O.getResource(r);if(d.refStore.get(u).dispose(),p){var f=new DataView(a.buffer);R(f.getFloat64(r+O.offset.async_id,!0),f.getFloat64(r+O.offset.trigger_async_id,!0))}i(r)},emptyQueueAndDelete:function(r){for(var e,t=O.getCallJSCb(r),n=O.getContext(r);O.getQueueSize(r)>0;)e=O.shiftQueue(r),t&&o.get(t)(0,0,n,e);O.destroy(r)},finalize:function(r){var e=O.getEnv(r),t=d.envStore.get(e);d.openScope(t);var n=O.getFinalizeCb(r),o=O.getFinalizeData(r),s=O.getContext(r),i=function(){t.callFinalizerInternal(0,n,o,s)};try{if(n)if(p){var u=O.getResource(r),f=d.refStore.get(u).get(),c=d.handleStore.get(f).value,l=new DataView(a.buffer),v=l.getFloat64(r+O.offset.async_id,!0),g=l.getFloat64(r+O.offset.trigger_async_id,!0);p.node.makeCallback(c,i,[],{asyncId:v,triggerAsyncId:g})}else i();O.emptyQueueAndDelete(r)}finally{d.closeScope(t)}},cleanup:function(r){O.closeHandlesAndMaybeDelete(r,1)},closeHandlesAndMaybeDelete:function(r,e){var t=O.getEnv(r),n=d.envStore.get(t);d.openScope(n);try{if(e&&O.getMutex(r).execute(function(){O.setIsClosing(r,1),O.getMaxQueueSize(r)>0&&O.getCond(r).signal()}),O.getHandlesClosing(r))return;O.setHandlesClosing(r,1),d.feature.setImmediate(function(){O.finalize(r)})}finally{d.closeScope(n)}},dispatchOne:function(r){var e=0,t=!1,n=!1,s=O.getMutex(r),i=O.getCond(r);if(s.execute(function(){if(O.getIsClosing(r))O.closeHandlesAndMaybeDelete(r,0);else{var a=O.getQueueSize(r);if(a>0){e=O.shiftQueue(r),t=!0;var o=O.getMaxQueueSize(r);a===o&&o>0&&i.signal(),a--}0===a?0===O.getThreadCount(r)&&(O.setIsClosing(r,1),O.getMaxQueueSize(r)>0&&i.signal(),O.closeHandlesAndMaybeDelete(r,0)):n=!0}}),t){var u=O.getEnv(r),f=d.envStore.get(u);d.openScope(f);var c=function(){f.callbackIntoModule(!1,function(){var t=O.getCallJSCb(r),n=O.getRef(r),a=n?d.refStore.get(n).get():0;if(t){var s=O.getContext(r);o.get(t)(u,a,s,e)}else{var i=a?d.handleStore.get(a).value:null;"function"==typeof i&&i()}})};try{if(p){var l=O.getResource(r),v=d.refStore.get(l).get(),g=d.handleStore.get(v).value,y=new DataView(a.buffer);p.node.makeCallback(g,c,[],{asyncId:y.getFloat64(r+O.offset.async_id,!0),triggerAsyncId:y.getFloat64(r+O.offset.trigger_async_id,!0)})}else c()}finally{d.closeScope(f)}}return n},dispatch:function(r){for(var e=!0,t=1e3,n=new Uint32Array(a.buffer),o=r+O.offset.dispatch_state>>2;e&&0!==--t;)Atomics.store(n,o,1),e=O.dispatchOne(r),1!==Atomics.exchange(n,o,0)&&(e=!0);e&&O.send(r)},send:function(r){1&~Atomics.or(new Uint32Array(a.buffer),r+O.offset.dispatch_state>>2,2)&&(void 0!==f&&f?postMessage({__emnapi__:{type:"tsfn-send",payload:{tsfn:r}}}):d.feature.setImmediate(function(){O.dispatch(r)}))}};var z={unusedWorkers:[],runningWorkers:[],workQueue:[],workerReady:null,offset:{resource:0,async_id:8,trigger_async_id:16,env:24,data:28,execute:32,complete:36,end:40},init:function(){z.unusedWorkers=[],z.runningWorkers=[],z.workQueue=[],z.workerReady=null},addListener:function(r){if(!r)return!1;if(r._emnapiAWMTListener)return!0;var e=function(e){var t=(u?e:e.data).__emnapi__;if(t){var n=t.type,a=t.payload;"async-work-complete"===n?(d.decreaseWaitingRequestCounter(),z.runningWorkers.splice(z.runningWorkers.indexOf(r),1),z.unusedWorkers.push(r),z.checkIdleWorker(),z.callComplete(a.work,0)):"async-work-queue"===n?z.scheduleWork(a.work):"async-work-cancel"===n&&z.cancelWork(a.work)}};return r._emnapiAWMTListener={handler:e,dispose:function(){u?r.off("message",e):r.removeEventListener("message",e,!1),delete r._emnapiAWMTListener}},u?r.on("message",e):r.addEventListener("message",e,!1),!0},initWorkers:function(r){if(f)return z.workerReady||(z.workerReady=Promise.resolve());if(z.workerReady)return z.workerReady;if("function"!=typeof y)throw new TypeError("`options.onCreateWorker` is not a function");var e=[],t=[];if(!("emnapi_async_worker_create"in n.exports))throw new TypeError("`emnapi_async_worker_create` is not exported, please try to add `--export=emnapi_async_worker_create` to linker flags");for(var a=0;a<r;++a)t.push(n.exports.emnapi_async_worker_create());try{var o=function(r){var n=y({type:"async-work",name:"emnapi-async-worker"}),a=S.loadWasmModuleToWorker(n);z.addListener(n),e.push(a.then(function(){"function"==typeof n.unref&&n.unref()})),z.unusedWorkers.push(n);var o=t[r];n.threadBlockBase=o,n.postMessage({__emnapi__:{type:"async-worker-init",payload:{arg:o}}})};for(a=0;a<r;++a)o(a)}catch(e){for(a=0;a<r;++a){var s=t[a];i(s)}throw e}return z.workerReady=Promise.all(e),z.workerReady},checkIdleWorker:function(){if(z.unusedWorkers.length>0&&z.workQueue.length>0){var r=z.unusedWorkers.shift(),e=z.workQueue.shift();z.runningWorkers.push(r),r.postMessage({__emnapi__:{type:"async-work-execute",payload:{work:e}}})}},getResource:function(r){return O.loadSizeTypeValue(r+z.offset.resource,!1)},getExecute:function(r){return O.loadSizeTypeValue(r+z.offset.execute,!1)},getComplete:function(r){return O.loadSizeTypeValue(r+z.offset.complete,!1)},getEnv:function(r){return O.loadSizeTypeValue(r+z.offset.env,!1)},getData:function(r){return O.loadSizeTypeValue(r+z.offset.data,!1)},scheduleWork:function(r){var e;if(f)(0,g.postMessage)({__emnapi__:{type:"async-work-queue",payload:{work:r}}});else if(d.increaseWaitingRequestCounter(),z.workQueue.push(r),null===(e=z.workerReady)||void 0===e?void 0:e.ready)z.checkIdleWorker();else{var t=function(r){throw d.decreaseWaitingRequestCounter(),r};try{z.initWorkers(m()).then(function(){z.workerReady.ready=!0,z.checkIdleWorker()},t)}catch(r){t(r)}}},cancelWork:function(r){if(f)return(0,g.postMessage)({__emnapi__:{type:"async-work-cancel",payload:{work:r}}}),0;var e=z.workQueue.indexOf(r);return-1!==e?(z.workQueue.splice(e,1),d.feature.setImmediate(function(){d.decreaseWaitingRequestCounter(),z.checkIdleWorker(),z.callComplete(r,11)}),0):9},callComplete:function(r,e){var t=z.getComplete(r),n=z.getEnv(r),s=z.getData(r),i=d.envStore.get(n),u=d.openScope(i),f=function(){t&&i.callbackIntoModule(!0,function(){o.get(t)(n,e,s)})};try{if(p){var c=z.getResource(r),l=d.refStore.get(c).get(),v=d.handleStore.get(l).value,g=new DataView(a.buffer),y=g.getFloat64(r+z.offset.async_id,!0),h=g.getFloat64(r+z.offset.trigger_async_id,!0);p.node.makeCallback(v,f,[],{asyncId:y,triggerAsyncId:h})}else f()}finally{d.closeScope(i,u)}}},M=L?function(r,e,t,n,o,s,i){if(!r)return 1;var u,f=d.envStore.get(r);if(f.checkGCAccess(),!n)return f.setLastError(1);if(!i)return f.setLastError(1);if(u=e?Object(d.handleStore.get(e).value):{},!t)return f.setLastError(1);var c=String(d.handleStore.get(t).value),l=j.create(r,u,c,n,o,s);return new DataView(a.buffer).setUint32(i,l,!0),f.clearLastError()}:function(r,e,t,n,o,i,u){if(!r)return 1;var f,c=d.envStore.get(r);if(c.checkGCAccess(),!n)return c.setLastError(1);if(!u)return c.setLastError(1);if(f=e?Object(d.handleStore.get(e).value):{},!t)return c.setLastError(1);var l=z.offset.end,p=s(l);if(!p)return c.setLastError(9);new Uint8Array(a.buffer).subarray(p,p+l).fill(0);var v=c.ensureHandleId(f),g=d.createReference(c,v,1,1).id,y=new DataView(a.buffer);return y.setUint32(p,g,!0),x(v,t,-1,p+z.offset.async_id),y.setUint32(p+z.offset.env,r,!0),y.setUint32(p+z.offset.execute,n,!0),y.setUint32(p+z.offset.complete,o,!0),y.setUint32(p+z.offset.data,i,!0),y.setUint32(u,p,!0),c.clearLastError()},F=L?function(r,e){if(!r)return 1;var t=d.envStore.get(r);return t.checkGCAccess(),e?(j.remove(e),t.clearLastError()):t.setLastError(1)}:function(r,e){if(!r)return 1;var t=d.envStore.get(r);if(t.checkGCAccess(),!e)return t.setLastError(1);var n=z.getResource(e);if(d.refStore.get(n).dispose(),p){var o=new DataView(a.buffer);R(o.getFloat64(e+z.offset.async_id,!0),o.getFloat64(e+z.offset.trigger_async_id,!0))}return i(e),t.clearLastError()},W=L?function(r,e){if(!r)return 1;var t=d.envStore.get(r);return e?(j.queue(e),t.clearLastError()):t.setLastError(1)}:function(r,e){if(!r)return 1;var t=d.envStore.get(r);return e?(z.scheduleWork(e),t.clearLastError()):t.setLastError(1)},N=L?function(r,e){if(!r)return 1;var t=d.envStore.get(r);if(!e)return t.setLastError(1);var n=j.cancel(e);return 0===n?t.clearLastError():t.setLastError(n)}:function(r,e){if(!r)return 1;var t=d.envStore.get(r);if(!e)return t.setLastError(1);var n=z.cancelWork(e);return 0===n?t.clearLastError():t.setLastError(n)};g.initWorker=function(r){if(!g.childThread)throw new Error("startThread is only available in child threads");if("function"!=typeof n.exports.emnapi_async_worker_init)throw new TypeError("`emnapi_async_worker_init` is not exported, please try to add `--export=emnapi_async_worker_init` to linker flags");n.exports.emnapi_async_worker_init(r)},g.executeAsyncWork=function(r){if(f){var e=z.getExecute(r),t=z.getEnv(r),n=z.getData(r);o.get(e)(t,n),(0,g.postMessage)({__emnapi__:{type:"async-work-complete",payload:{work:r}}})}};var J=Object.freeze({__proto__:null,napi_cancel_async_work:N,napi_create_async_work:M,napi_delete_async_work:F,napi_queue_async_work:W}),P={registry:"function"==typeof FinalizationRegistry?new FinalizationRegistry(function(r){i(r)}):void 0,table:new WeakMap,wasmMemoryViewTable:new WeakMap,init:function(){P.registry="function"==typeof FinalizationRegistry?new FinalizationRegistry(function(r){i(r)}):void 0,P.table=new WeakMap,P.wasmMemoryViewTable=new WeakMap},isSharedArrayBuffer:function(r){return"function"==typeof SharedArrayBuffer&&r instanceof SharedArrayBuffer||"[object SharedArrayBuffer]"===Object.prototype.toString.call(r)},isDetachedArrayBuffer:function(r){if(0===r.byteLength)try{new Uint8Array(r)}catch(r){return!0}return!1},getArrayBufferPointer:function(r,e){var t,n={address:0,ownership:0,runtimeAllocated:0};if(r===a.buffer)return n;var o=P.isDetachedArrayBuffer(r);if(P.table.has(r)){var i=P.table.get(r);return o?(i.address=0,i):(e&&0===i.ownership&&1===i.runtimeAllocated&&new Uint8Array(a.buffer).set(new Uint8Array(r),i.address),i)}if(o||0===r.byteLength)return n;if(!e)return n;var u=s(r.byteLength);if(!u)throw new Error("Out of memory");return new Uint8Array(a.buffer).set(new Uint8Array(r),u),n.address=u,n.ownership=P.registry?0:1,n.runtimeAllocated=1,P.table.set(r,n),null===(t=P.registry)||void 0===t||t.register(r,u),n},getOrUpdateMemoryView:function(r){if(r.buffer===a.buffer)return P.wasmMemoryViewTable.has(r)||P.wasmMemoryViewTable.set(r,{Ctor:r.constructor,address:r.byteOffset,length:r instanceof DataView?r.byteLength:r.length,ownership:1,runtimeAlloc